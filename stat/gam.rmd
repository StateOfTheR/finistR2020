---
title: "GAM"
author: "P. Gloaguen, P. Barbillon, G. Massiot, MP Etienne"
date: "8/24/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Base de splines 

On veut construire une base de $k$ fonctions splines $(s_1, \ldots, s_k)$. Pour ceci, ondéfinit $k$ noeuds, par défaut les extréminités correspondent à $x_{min}$ et $x_{max}$.

Chaque fonction $s_i$ vaut 1 au noeud $i$ et 0 aux autres noeuds. En outre. Chaque fonction spline (cublique) est le recollement de $k$ polynomes de degré 3 assurant une fonction  de classe $C^2$  sur l'intervalle, comme illustré ci-dessous (extrait du livre de S. Wood).



![img](img/spline.jpg)


```{r}
library(mgcv)
library(tidyverse)
library(MASS)
```







```{r}
Mods3 <- gam(accel~s(times,k=10,bs="cr"),data=mcycle)
gam.check(Mods3)
summary(Mods3)
```

$$Y_i = Z_i^T\theta + \sum_{j=1}^p \beta_j f_j(x_{i}) + \epsilon_i$$
où les $f_j$ forment une base de spline, $Z_i$ des variables utilisées comme dans un modèle linéaire, et $x_i$ la variable pour laquelle on utilise une spline. Notons qu'on peut avoir des splines multivariés et plusieurs splines dépendant de différentes variables.

Dans le tableau, Parametric Coefficients correspond à la partie des effets linéaires et la partie smooth terms correspond au test sur la variable dont dépend le spline.

La dernière partie contient des informations sur la qualité d'ajustement du modèle type $R^2$ et variance estimée.

Ce tableau contient les $\beta_j$ devant les splines :
```{r}
coef(Mods3)
```





