<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="State of the R" />


<title>3D scatterplots for PLNPCA</title>

<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.15/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="site_libs/d3v5-5.9.2/d3.v5.min.js"></script>
<script src="site_libs/d3v5-5.9.2/d3-legend.min.js"></script>
<script src="site_libs/d3v5-5.9.2/d3-labeler.js"></script>
<link href="site_libs/d3.lasso-plugin-1.0.0/lasso.css" rel="stylesheet" />
<script src="site_libs/d3.lasso-plugin-1.0.0/lasso.js"></script>
<link href="site_libs/scatterD3-0.8.2/scatterD3.css" rel="stylesheet" />
<script src="site_libs/scatterD3-0.8.2/scatterD3-utils.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-scales.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-dims.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-menu.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-axes.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-dots.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-arrows.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-labels.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-lines.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-ellipses.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-zoom.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-legend.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-lasso.js"></script>
<script src="site_libs/scatterD3-0.8.2/scatterD3-exports.js"></script>
<script src="site_libs/scatterD3-binding-0.9/scatterD3.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="site_libs/threejs-111/three.min.js"></script>
<script src="site_libs/threejs-111/Detector.js"></script>
<script src="site_libs/threejs-111/Projector.js"></script>
<script src="site_libs/threejs-111/CanvasRenderer.js"></script>
<script src="site_libs/threejs-111/TrackballControls.js"></script>
<script src="site_libs/threejs-111/StateOrbitControls.js"></script>
<script src="site_libs/scatterplotThree-binding-0.3.3/scatterplotThree.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Finist'R 2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://github.com/StateOfTheR/finistR2020">
    <span class="fa fa-github"></span>
     
    
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Enseignement
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="teach_learnr_gradethis.html">LearnR and gradethis</a>
    </li>
    <li>
      <a href="teach_swirl.html">Swirl</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-gear"></span>
     
    Intégration Continue
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ci_github_actions.html">GithubActions</a>
    </li>
    <li>
      <a href="ci_binderetal.html">Binder</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-mouse-pointer"></span>
     
    Widgets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="widget_timevis.html">Timevis</a>
    </li>
    <li>
      <a href="widget_graph_visualization.html">Network viz</a>
    </li>
    <li>
      <a href="widget_ggiraph.html">ggiraph, plotly</a>
    </li>
    <li>
      <a href="widget_heatmaps.html">Heatmaps</a>
    </li>
    <li>
      <a href="widget_scatterplots.html">(3D) Scatterplots</a>
    </li>
    <li class="dropdown-header">Cartogrammes</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="far fa far fa-keyboard"></span>
     
    R avancé
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_python.html">R et Python</a>
    </li>
    <li>
      <a href="r_tidy_prog.html">Progammation avec le tidyverse</a>
    </li>
    <li>
      <a href="r_citr.html">Bibliographie</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-angle-double-right"></span>
     
    Optimisation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="optim_optimLib.html">Bibliothèque OptimLib</a>
    </li>
    <li class="dropdown-header">Interface avec torch (plante)</li>
    <li>
      <a href="optim_RKeOps.html">Interface avec KeOps</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-chart-bar"></span>
     
    Modélisation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="model_gam.html">Modèles additifs - GAM</a>
    </li>
    <li>
      <a href="model_edo.html">Équations différentielles avec R</a>
    </li>
    <li>
      <a href="model_distributions.html">Manipulation des distributions</a>
    </li>
    <li>
      <a href="model_tidymodels.html">Introduction à Tidymodels</a>
    </li>
    <li>
      <a href="model_tidyverts.html">Introduction à Tidyverts</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">3D scatterplots for PLNPCA</h1>
<h4 class="author">State of the R</h4>
<h4 class="date">24-28/08/2020</h4>

</div>


<div id="preliminaries" class="section level2">
<h2>Preliminaries</h2>
<p>We will illustrate some widgets for 3D scatterplots to enhance output of PCA in <strong>PLNmodels</strong>. The packages required for the analysis are <strong>PLNmodels</strong> plus some others for data manipulation and representation:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(PLNmodels)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>Here are a collection of packages implementing various JS widgets:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(DT)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">library</span>(scatterD3)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="kw">library</span>(plotly)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="kw">library</span>(edgebundleR)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">library</span>(threejs)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="kw">library</span>(networkD3)</span></code></pre></div>
<p>The <em>oaks amplicon data set</em> at play gives the abundance of 114 taxa (66 bacterial OTU, 48 fungal OTUs) in 116 samples. For each sample, 11 additional covariates are known</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">data</span>(oaks)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">datatable</span>(oaks<span class="op">$</span>Abundance[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] )</span></code></pre></div>
<div id="htmlwidget-ecee6fd026e688b8d84c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ecee6fd026e688b8d84c">{"x":{"filter":"none","data":[["A1.02","A1.03","A1.04","A1.05","A1.06","A1.07","A1.08","A1.09","A1.10","A1.11","A1.12","A1.13","A1.14","A1.15","A1.16","A1.17","A1.18","A1.19","A1.20","A1.21","A1.22","A1.23","A1.24","A1.25","A1.26","A1.28","A1.29","A1.30","A1.31","A1.32","A1.33","A1.34","A1.35","A1.36","A1.37","A1.38","A1.39","A1.40","A2.01","A2.02","A2.03","A2.04","A2.05","A2.06","A2.07","A2.08","A2.09","A2.10","A2.11","A2.12","A2.13","A2.14","A2.15","A2.16","A2.17","A2.18","A2.19","A2.20","A2.21","A2.22","A2.23","A2.24","A2.25","A2.26","A2.28","A2.29","A2.30","A2.31","A2.32","A2.33","A2.34","A2.35","A2.36","A2.37","A2.38","A2.39","A2.40","A3.01","A3.02","A3.03","A3.04","A3.05","A3.06","A3.08","A3.09","A3.10","A3.11","A3.12","A3.13","A3.14","A3.15","A3.16","A3.17","A3.18","A3.19","A3.20","A3.21","A3.22","A3.23","A3.24","A3.25","A3.26","A3.27","A3.28","A3.29","A3.30","A3.31","A3.32","A3.33","A3.34","A3.35","A3.36","A3.37","A3.38","A3.39","A3.40"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,18,42,54,35,2,0,0,21,1,170,7,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,4,2,0,1,0,0,53,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,10],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,93,1,178,4,0,0,1,0,0,0,0,10,6,0,0,0,0,0,7,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,15,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,2,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,297,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[6,0,2,1,4,77,21,27,7,7,2,4,0,29,3,99,41,6,1,13,15,10,17,11,25,50,4,9,249,6,11,9,6,8,15,7,13,15,44,258,451,176,12,14,26,219,11,1267,203,5,8,4,4,10,137,119,95,1388,4,16,17,39,321,343,43,134,2228,683,8,437,386,5,6,5,98,188,32,13,2,3,4,3,310,8,2,9,1,0,0,2,32,6,5,0,15,5,0,3,8,0,4,3,4,9,26,71,6,1,7,14,1,6,3,5,2,151],[146,0,0,1,1,2,2,4,42,2,11,2,3,0,0,1,0,0,0,0,5,0,1,0,0,0,2,2,6,1,0,1,4,0,0,0,1,0,0,0,0,0,0,0,0,2,1,1,0,0,0,0,0,1,0,0,0,0,4,0,0,1,1,0,1,0,0,2,0,0,0,0,0,1,0,2,0,1,1,9,0,0,1,1,2,6,4,0,0,0,3,1,1,0,0,1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,3,1,2,1,0,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>b_OTU_1045<\/th>\n      <th>b_OTU_109<\/th>\n      <th>b_OTU_1093<\/th>\n      <th>b_OTU_11<\/th>\n      <th>b_OTU_112<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="plnmodels-analyses" class="section level2">
<h2>PLNmodels Analyses</h2>
<div id="pca-analysis" class="section level3">
<h3>PCA analysis</h3>
<p>We only fit two PCA models, which we know are in the right range for ICL</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>my_PCAs &lt;-<span class="st"> </span><span class="kw">PLNPCA</span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(Offset)), <span class="dt">data =</span> oaks, <span class="dt">ranks =</span> <span class="dv">27</span><span class="op">:</span><span class="dv">28</span>)</span></code></pre></div>
</div>
</div>
<div id="outputs-and-vizualisation" class="section level2">
<h2>Outputs and Vizualisation</h2>
<div id="principal-components-map" class="section level3">
<h3>Principal Components Map</h3>
<p>We explore various scatterplot solutions to represent the individual factor map of the PLN PCA.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>coord &lt;-<span class="st"> </span>my_PCAs<span class="op">$</span><span class="kw">getBestModel</span>()<span class="op">$</span>scores[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;PC3&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">add_column</span>(<span class="dt">tree =</span> oaks<span class="op">$</span>tree, <span class="dt">names =</span> <span class="kw">rownames</span>(oaks<span class="op">$</span>Abundance))</span></code></pre></div>
<div id="scatterd3-another-fancy-scatterplot" class="section level4">
<h4>ScatterD3 (Another fancy scatterplot)</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">scatterD3</span>(<span class="dt">data =</span> coord, <span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2, <span class="dt">lab =</span> names,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>          <span class="dt">col_var =</span> tree, <span class="dt">symbol_var =</span> tree,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>          <span class="dt">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;PC2&quot;</span>, <span class="dt">col_lab =</span> <span class="st">&quot;tree&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>          <span class="dt">symbol_lab =</span> <span class="st">&quot;tree&quot;</span>, <span class="dt">lasso =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-7a43ad3789c92b7c34df" style="width:960px;height:960px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-7a43ad3789c92b7c34df">{"x":{"data":{"x":[-17.7833592688912,-11.7502161167263,-9.86647288932152,-8.94149208264057,-10.3167335716938,-11.8039795698307,-7.72326215162717,-10.7942208465414,-11.2888957573938,-10.2941778848548,-10.1159649881831,-11.2301576574925,-11.7421109500382,-8.74378286485745,-8.20954582792194,-4.59256392797216,-5.02219922378362,-11.8786325944426,-11.0751965424959,-1.53881843377341,-10.0713068115633,-11.0620575172444,-8.26009201282948,-12.3735102382268,-10.6127831388237,-9.20536485723951,-14.5939730292977,-10.0324511501578,-7.51807774227222,-8.9628403027442,-8.69029185400999,-9.79621644941148,-10.6877987567335,-16.1621070148717,-12.0698643654371,-14.8027105645251,-11.8873995708987,-7.01969369615113,16.2616324205999,16.4985346033266,18.1180571811308,18.5972182009659,10.7786285916623,10.777377557537,12.4720984905663,18.4744952040402,15.6596636190914,26.0023943624578,16.0688164872678,9.87618644684041,9.13339650356201,9.26868875239891,9.64679687661673,12.1983336162019,12.9690501105871,14.9989120758309,12.5427368429655,20.991610255102,10.8350629801962,6.12709253949173,11.6751423438717,10.7612206103667,12.920995454261,18.1490593955936,10.1197901650885,12.058565716377,18.1844370237197,12.9823013764381,7.18459701585125,17.8053552609941,17.063835524035,7.43651587988977,4.16249333924788,6.1927677767288,12.6270542091092,9.82455046941162,10.3726108217366,-0.941121026354565,-3.66123372077501,-5.21504625524819,-1.37527586742584,0.832355984920883,3.6910855258137,-1.22422746184332,-3.46059534226015,-3.15020494038558,-2.92379400502621,-4.21585306493568,-0.867160290907811,0.486202132548909,-2.54591736529001,-9.79725557106884,-3.27162694271443,-4.37547151053771,-6.56150139255464,-2.31287215207989,-3.4533247065001,-5.29635420957231,0.839791469727921,-5.14975044024028,-7.08283238033914,-3.55693878253449,0.0276021264340439,-5.32130058363106,-4.61574973401149,-1.64187762918406,-4.9640164125254,-4.23620386902414,-5.24376039276334,-2.36000139707441,-5.98588680689827,-2.04626934573926,-2.45140282820161,-5.07920861770813,-4.65281950799921,3.86206343566882],"y":[5.79415216238735,9.71294175678263,8.89052352604502,2.58949387967257,4.21804125292576,4.57072431514474,3.40844721326658,3.08789607505424,5.53804311236509,7.98635124423186,8.76205901579369,9.72479142781256,10.9332454107066,11.0690279964136,15.1665634131137,15.2158305800195,7.35049796746596,9.19309518588623,8.94830286860253,10.2872044162463,8.18533557855479,4.27218313433123,6.07347194764022,5.32413465548355,2.73452940466528,5.02731608489237,8.49582260940801,3.36329129681019,1.64396877867796,10.779887277866,11.8408563297183,8.61997791380407,11.3219223203663,9.33532048928814,7.05470148539759,6.76718704021497,5.59316445911409,1.92117626510962,-1.61378687601069,-1.30196599566597,-1.19612597189906,-1.39545404807389,4.70867874729886,0.89607969562882,3.54243550068528,-0.0155433523433726,-3.23761513626913,-2.23922643405341,5.22093359105851,1.95001297126643,1.25282523774863,0.93133617356633,3.34133315078055,4.86921661804463,4.9653727780262,5.4339973817538,3.21168939850743,2.08946856657572,4.41406218928363,5.7183391509398,1.40156104861068,2.92104221228263,3.20401719941206,6.94119434486104,5.5311385578902,5.25281671257514,1.06356644251513,7.91629449155805,9.22820574081531,7.18204509646726,6.47079462449164,5.97551218180172,8.09151522368417,3.02403964411424,10.4622624766987,14.3061450825413,-0.424546601950525,-10.720192462836,-8.25891355894609,-10.3910837278003,-12.8857991775026,-8.54137138123887,-13.9509800980863,-12.3752262843778,-13.8308689785737,-12.1850430030433,-8.10762265891392,-1.04476719741931,-6.04667342880542,-6.65456567305325,-8.16873989282517,-11.3737661317367,-11.1695458888718,-9.52264072921688,-12.299932896858,-10.7549843139184,-16.2889650020838,-12.4762972572949,-10.5121506105955,-10.7461314989155,-10.5964264672648,-11.602599330679,-9.12072944878954,-13.0577899784393,-12.7984465474023,-13.0650339458793,-9.53284981389857,-10.1661138432507,-10.0464527025729,-13.413447936202,-11.4935807353242,-6.50822568314949,-14.4010998338471,-10.6292352959949,-10.0206704964991,-16.1361837943903],"lab":["A1.02","A1.03","A1.04","A1.05","A1.06","A1.07","A1.08","A1.09","A1.10","A1.11","A1.12","A1.13","A1.14","A1.15","A1.16","A1.17","A1.18","A1.19","A1.20","A1.21","A1.22","A1.23","A1.24","A1.25","A1.26","A1.28","A1.29","A1.30","A1.31","A1.32","A1.33","A1.34","A1.35","A1.36","A1.37","A1.38","A1.39","A1.40","A2.01","A2.02","A2.03","A2.04","A2.05","A2.06","A2.07","A2.08","A2.09","A2.10","A2.11","A2.12","A2.13","A2.14","A2.15","A2.16","A2.17","A2.18","A2.19","A2.20","A2.21","A2.22","A2.23","A2.24","A2.25","A2.26","A2.28","A2.29","A2.30","A2.31","A2.32","A2.33","A2.34","A2.35","A2.36","A2.37","A2.38","A2.39","A2.40","A3.01","A3.02","A3.03","A3.04","A3.05","A3.06","A3.08","A3.09","A3.10","A3.11","A3.12","A3.13","A3.14","A3.15","A3.16","A3.17","A3.18","A3.19","A3.20","A3.21","A3.22","A3.23","A3.24","A3.25","A3.26","A3.27","A3.28","A3.29","A3.30","A3.31","A3.32","A3.33","A3.34","A3.35","A3.36","A3.37","A3.38","A3.39","A3.40"],"col_var":["intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant"],"symbol_var":["intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","intermediate","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","susceptible","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant","resistant"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"PC1","ylab":"PC2","has_labels":true,"col_lab":"tree","col_continuous":false,"col_levels":["susceptible","intermediate","resistant"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"tree","symbol_levels":["susceptible","intermediate","resistant"],"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":true,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-KSDRWCYM","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":true,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="native-plotly-3d-scatterplot" class="section level4">
<h4>Native plotly (3D scatterplot)</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>fig &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>  coord, <span class="dt">x =</span> <span class="op">~</span>PC1, <span class="dt">y =</span> <span class="op">~</span>PC2, <span class="dt">z =</span> <span class="op">~</span>PC3, <span class="dt">color =</span> <span class="op">~</span>tree, <span class="dt">size =</span> <span class="fl">.35</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>  <span class="dt">text =</span> <span class="op">~</span><span class="kw">paste</span>(<span class="st">&#39;status:&#39;</span>, tree), <span class="dt">type =</span> <span class="st">&quot;scatter3d&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&quot;Individual Factor Map of the Oaks powdery Mildew data set&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>         <span class="dt">scene =</span> <span class="kw">list</span>(<span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&#39;PC1&#39;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>                      <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&#39;PC2&#39;</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>                      <span class="dt">zaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&#39;PC3&#39;</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>  )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>fig</span></code></pre></div>
<div id="htmlwidget-4a77b4189b0c9ac708bd" style="width:960px;height:960px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a77b4189b0c9ac708bd">{"x":{"visdat":{"64d22329bac3":["function () ","plotlyVisDat"]},"cur_data":"64d22329bac3","attrs":{"64d22329bac3":{"x":{},"y":{},"z":{},"text":{},"color":{},"size":0.35,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Individual Factor Map of the Oaks powdery Mildew data set","scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[16.2616324205999,16.4985346033266,18.1180571811308,18.5972182009659,10.7786285916623,10.777377557537,12.4720984905663,18.4744952040402,15.6596636190914,26.0023943624578,16.0688164872678,9.87618644684041,9.13339650356201,9.26868875239891,9.64679687661673,12.1983336162019,12.9690501105871,14.9989120758309,12.5427368429655,20.991610255102,10.8350629801962,6.12709253949173,11.6751423438717,10.7612206103667,12.920995454261,18.1490593955936,10.1197901650885,12.058565716377,18.1844370237197,12.9823013764381,7.18459701585125,17.8053552609941,17.063835524035,7.43651587988977,4.16249333924788,6.1927677767288,12.6270542091092,9.82455046941162,10.3726108217366],"y":[-1.61378687601069,-1.30196599566597,-1.19612597189906,-1.39545404807389,4.70867874729886,0.89607969562882,3.54243550068528,-0.0155433523433726,-3.23761513626913,-2.23922643405341,5.22093359105851,1.95001297126643,1.25282523774863,0.93133617356633,3.34133315078055,4.86921661804463,4.9653727780262,5.4339973817538,3.21168939850743,2.08946856657572,4.41406218928363,5.7183391509398,1.40156104861068,2.92104221228263,3.20401719941206,6.94119434486104,5.5311385578902,5.25281671257514,1.06356644251513,7.91629449155805,9.22820574081531,7.18204509646726,6.47079462449164,5.97551218180172,8.09151522368417,3.02403964411424,10.4622624766987,14.3061450825413,-0.424546601950525],"z":[7.1877412733104,7.26564230516443,7.67488119771431,7.14334471514301,5.98688760978883,5.42761515621352,-2.22892985072847,13.3390800260053,7.0711621984902,3.4288379142709,-4.77816122231855,-6.44450492997041,-11.0966835938709,-7.06481823410194,-10.5207346998889,-8.21438714861369,-1.68649281167325,6.83677271118256,8.29188710206426,3.97198197705007,3.18123230839533,0.0785222537635605,-2.76008615373367,-1.83373292950448,3.93827714676893,2.86709392074191,8.31760327370038,3.80235432308928,5.8964918943952,-10.2371358561866,-7.79384960018143,-8.42636977943419,-6.47539724128299,-11.855880360134,-21.6209247794922,4.21348587892467,-13.5453799148258,-7.62194795016495,9.29502647094198],"text":["status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible","status: susceptible"],"type":"scatter3d","mode":"markers","name":"susceptible","marker":{"color":"rgba(102,194,165,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)","size":55},"error_y":{"color":"rgba(102,194,165,1)","width":55},"error_x":{"color":"rgba(102,194,165,1)","width":55},"line":{"color":"rgba(102,194,165,1)","width":55},"frame":null},{"x":[-17.7833592688912,-11.7502161167263,-9.86647288932152,-8.94149208264057,-10.3167335716938,-11.8039795698307,-7.72326215162717,-10.7942208465414,-11.2888957573938,-10.2941778848548,-10.1159649881831,-11.2301576574925,-11.7421109500382,-8.74378286485745,-8.20954582792194,-4.59256392797216,-5.02219922378362,-11.8786325944426,-11.0751965424959,-1.53881843377341,-10.0713068115633,-11.0620575172444,-8.26009201282948,-12.3735102382268,-10.6127831388237,-9.20536485723951,-14.5939730292977,-10.0324511501578,-7.51807774227222,-8.9628403027442,-8.69029185400999,-9.79621644941148,-10.6877987567335,-16.1621070148717,-12.0698643654371,-14.8027105645251,-11.8873995708987,-7.01969369615113],"y":[5.79415216238735,9.71294175678263,8.89052352604502,2.58949387967257,4.21804125292576,4.57072431514474,3.40844721326658,3.08789607505424,5.53804311236509,7.98635124423186,8.76205901579369,9.72479142781256,10.9332454107066,11.0690279964136,15.1665634131137,15.2158305800195,7.35049796746596,9.19309518588623,8.94830286860253,10.2872044162463,8.18533557855479,4.27218313433123,6.07347194764022,5.32413465548355,2.73452940466528,5.02731608489237,8.49582260940801,3.36329129681019,1.64396877867796,10.779887277866,11.8408563297183,8.61997791380407,11.3219223203663,9.33532048928814,7.05470148539759,6.76718704021497,5.59316445911409,1.92117626510962],"z":[-4.17553861562871,-4.00948607547743,1.02603600230394,5.11638804132052,3.8580088933437,0.869715837580854,7.77331177855351,6.21414399102503,7.15569955334622,4.3508427037196,5.83895033768298,-3.47373151075195,2.94444163988965,-1.31401536660308,-2.14366326976935,-2.95513683678651,6.62611727636261,0.428995688621983,3.94099544954732,-0.047127809690187,0.422038738084297,2.05579351830897,5.43914708403794,8.44327139141657,6.02147621613556,5.37881305475889,-1.5285841243898,7.7813530579095,6.05827343715806,-3.63768892831437,-2.44183016761345,-1.6630772569392,1.10347424826772,-3.3771457435415,2.30231551556122,-0.155317036969945,6.35824986363407,9.12691876591796],"text":["status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate","status: intermediate"],"type":"scatter3d","mode":"markers","name":"intermediate","marker":{"color":"rgba(252,141,98,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":55},"error_y":{"color":"rgba(252,141,98,1)","width":55},"error_x":{"color":"rgba(252,141,98,1)","width":55},"line":{"color":"rgba(252,141,98,1)","width":55},"frame":null},{"x":[-0.941121026354565,-3.66123372077501,-5.21504625524819,-1.37527586742584,0.832355984920883,3.6910855258137,-1.22422746184332,-3.46059534226015,-3.15020494038558,-2.92379400502621,-4.21585306493568,-0.867160290907811,0.486202132548909,-2.54591736529001,-9.79725557106884,-3.27162694271443,-4.37547151053771,-6.56150139255464,-2.31287215207989,-3.4533247065001,-5.29635420957231,0.839791469727921,-5.14975044024028,-7.08283238033914,-3.55693878253449,0.0276021264340439,-5.32130058363106,-4.61574973401149,-1.64187762918406,-4.9640164125254,-4.23620386902414,-5.24376039276334,-2.36000139707441,-5.98588680689827,-2.04626934573926,-2.45140282820161,-5.07920861770813,-4.65281950799921,3.86206343566882],"y":[-10.720192462836,-8.25891355894609,-10.3910837278003,-12.8857991775026,-8.54137138123887,-13.9509800980863,-12.3752262843778,-13.8308689785737,-12.1850430030433,-8.10762265891392,-1.04476719741931,-6.04667342880542,-6.65456567305325,-8.16873989282517,-11.3737661317367,-11.1695458888718,-9.52264072921688,-12.299932896858,-10.7549843139184,-16.2889650020838,-12.4762972572949,-10.5121506105955,-10.7461314989155,-10.5964264672648,-11.602599330679,-9.12072944878954,-13.0577899784393,-12.7984465474023,-13.0650339458793,-9.53284981389857,-10.1661138432507,-10.0464527025729,-13.413447936202,-11.4935807353242,-6.50822568314949,-14.4010998338471,-10.6292352959949,-10.0206704964991,-16.1361837943903],"z":[-1.28577977821876,-0.454088187581414,-4.1430934618739,-2.17296998954711,4.3645188552486,1.22833971152246,3.0744808458692,6.23578845276161,7.6407417859401,-8.55531243244299,-7.02384273257086,-1.81545160271239,-11.9301201917598,-7.57260208096715,-10.5081621694327,0.00895310889393131,0.651570300910239,-1.26656116857161,0.54226816018516,0.446523514723772,-1.23907548486605,3.86528075780197,-5.28919879860324,-6.82080198740296,-1.21930134907565,-0.754443933680854,-0.0681603956629,3.22315194362214,3.04632710513972,0.456726642866563,-7.88840027690415,-4.83356851168123,-2.62037942838994,-6.5843319607581,-6.75487246732141,-6.0340993042413,-1.23864060069225,0.110308846820356,6.45534431962687],"text":["status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant","status: resistant"],"type":"scatter3d","mode":"markers","name":"resistant","marker":{"color":"rgba(141,160,203,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)","size":55},"error_y":{"color":"rgba(141,160,203,1)","width":55},"error_x":{"color":"rgba(141,160,203,1)","width":55},"line":{"color":"rgba(141,160,203,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="threejs-3d-scatterplot" class="section level4">
<h4>threejs (3D scatterplot)</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>group &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">3</span>)[<span class="kw">as.numeric</span>(oaks<span class="op">$</span>tree)]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>coord <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="kw">scatterplot3js</span>(<span class="dt">col =</span> group, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="dt">grid =</span> <span class="ot">FALSE</span>, <span class="dt">bg =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div id="9JDrqw0R7U" style="width:960px;height:960px;" class="scatterplotThree html-widget"></div>
<script type="application/json" data-for="9JDrqw0R7U">{"x":{"NROW":116,"height":null,"width":null,"axis":true,"numticks":[6,6,6],"xticklabs":null,"yticklabs":null,"zticklabs":null,"color":[["#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#00FF00","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF"]],"size":0.25,"stroke":"black","flipy":true,"grid":false,"renderer":"auto","signif":8,"bg":"black","cexsymbols":1,"xlim":{},"ylim":{},"zlim":{},"axisscale":[1,1,1],"pch":[".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","."],"elementId":"9JDrqw0R7U","axisLabels":["PC1","PC3","PC2"],"linealpha":1,"alpha":[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"vertices":[[0,0.49900983,0.29905537,0.13778781,0.50375962,0.17466829,0.18080964,0.64779627,0.20077283,0.2019348,0.76479717,0.40077507,0.17052637,0.72880235,0.34908302,0.13655994,0.64332487,0.33788844,0.22975731,0.84079612,0.37478051,0.15962129,0.79619751,0.38495519,0.14832367,0.82312987,0.30718458,0.17104151,0.74289943,0.22947235,0.17511162,0.78546543,0.20485045,0.14966516,0.5190844,0.17429217,0.13797292,0.70267057,0.13593439,0.20645017,0.58086117,0.13162449,0.21865133,0.55712983,0.001563799,0.3012577,0.53391835,0,0.29144548,0.80798164,0.24965509,0.13485497,0.63071846,0.19116885,0.15320423,0.73117611,0.19893885,0.3710006,0.61709937,0.15644051,0.17613155,0.63051946,0.22315634,0.15350431,0.67725157,0.3473645,0.21749694,0.77402941,0.29018943,0.12355272,0.85995973,0.31397429,0.16376505,0.79068642,0.39617147,0.19590834,0.77230361,0.32339567,0.07284073,0.57472362,0.21330111,0.17701895,0.84102614,0.37621381,0.23444341,0.79173897,0.43078717,0.20144723,0.51439455,0.14080216,0.20767183,0.54860103,0.10712573,0.18241419,0.57087657,0.20936027,0.16205181,0.65001132,0.12359732,0.037026935,0.52184715,0.18665444,0.13048753,0.68430312,0.25904403,0.068073482,0.61400471,0.26817008,0.13465475,0.80031953,0.30543496,0.24582575,0.87951485,0.42198827,0.77753582,0.8240464,0.53419224,0.7829463,0.82627469,0.52429468,0.81993373,0.8379806,0.52093519,0.83087704,0.82277647,0.5272621,0.65231235,0.78969704,0.3335096,0.65228378,0.77369955,0.45452607,0.69098863,0.55469085,0.37052756,0.82807424,1,0.48346208,0.76378776,0.82071176,0.5857345,1,0.71652629,0.55404445,0.77313219,0.48177235,0.31725002,0.63170194,0.43410806,0.42107296,0.61473775,0.30103661,0.44320254,0.61782762,0.41636455,0.45340699,0.62646304,0.31751111,0.37691079,0.68473625,0.38348214,0.32841394,0.70233825,0.57020679,0.32536183,0.7486972,0.81400725,0.31048712,0.6926019,0.85562951,0.38102584,0.88556131,0.73206245,0.41664647,0.65360123,0.70944376,0.34286108,0.54607834,0.62069348,0.30146177,0.67278736,0.5394976,0.43848148,0.65191478,0.56599511,0.39025133,0.70124075,0.73109835,0.38126936,0.82064178,0.7004581,0.26264688,0.63726548,0.8563651,0.30740374,0.68154417,0.7272104,0.31623801,0.82144975,0.78711135,0.44920984,0.70264088,0.32562321,0.23169603,0.57023014,0.39551125,0.19005439,0.8127921,0.37741857,0.25500199,0.79585691,0.43322441,0.27757793,0.57598358,0.27932045,0.29329879,0.50120989,0,0.22613431,0.54757827,0.73897046,0.38698207,0.69452758,0.23099381,0.15088395,0.63052266,0.40042834,0.028874509,0.64303952,0.88432343,0.49644433,0.3846511,0.58166883,0.82324048,0.32252786,0.60545863,0.74511654,0.28704115,0.4999379,0.81279417,0.37473566,0.55629154,0.89197943,0.42515462,0.74329062,0.75408209,0.49044365,0.65358299,0.92578955,0.37818538,0.70639022,0.87577324,0.32711014,0.79681663,0.92197708,0.33419898,0.83700408,0.86973659,0.33936986,0.37373028,0.74031438,0.3098612,0.41753661,0.51613088,0.38634025,0.56651803,0.67489738,0.41724899,0.27719689,0.69419261,0.34799999,0.40183984,0.74225432,0.18239046,0.31787074,0.84398569,0.33142589,0.61870352,0.8375035,0.30621576,0.63708501,0.78522875,0.25629016,0.58221856,0.87338334,0.35332239,0.63395852,0.82434482,0.32727619,0.63121983,1,0.2851842,0.58300476,0.87898135,0.42532443,0.72901036,0.81663698,0.28853241,0.46715457,0.82406382,0.24438376,0.42334442,0.819312,0.3249098,0.58357038,0.85124913,0.40677526,0.59686722,0.77247161,0.28461446,0.61649775,0.89743863,0.30072817,0.71064283,0.88920676,0.36864688,0.70558491,0.89766856,0.29277429,0.63151168,0.7855528,0.30939642,0.39280671,0.80565336,0.28638536,0.48018747,0.80185517,0.35224603,0.54349379,0.90872764,0.26943632,0.43010843,0.84778875,0.35941119,0.42523027,0.6895476,0.35015856,0.44584735,0.9400769,0.29014347,0.5830172,0.82035339,0.29988155,0.62160271,0.80103681,0.49434852,0.80309683,0.99515054]],"xticklab":["-17.78","-9.03","-0.27","8.49","17.25","26.00"],"yticklab":["-21.62","-14.63","-7.64","-0.64","6.35","13.34"],"zticklab":["15.22","8.91","2.61","-3.69","-9.99","-16.29"],"xtick":[0,0.2,0.4,0.6,0.8,1],"ytick":[0,0.2,0.4,0.6,0.8,1],"ztick":[0,0.2,0.4,0.6,0.8,1],"axislength":[1,1,1]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
